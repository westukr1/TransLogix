FROM node:20 AS build
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .

ARG REACT_APP_GIT_SHA
ARG REACT_APP_VERSION
ARG REACT_APP_BUILD_TIME
ARG REACT_APP_COMMIT_TIME
ENV REACT_APP_GIT_SHA=$REACT_APP_GIT_SHA
ENV REACT_APP_VERSION=$REACT_APP_VERSION
ENV REACT_APP_BUILD_TIME=$REACT_APP_BUILD_TIME
ENV REACT_APP_COMMIT_TIME=$REACT_APP_COMMIT_TIME

RUN npm run build

FROM nginx:alpine
COPY --from=build /app/build /usr/share/nginx/html
EXPOSE 80
